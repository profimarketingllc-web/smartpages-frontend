---
const API_URL = "https://smartcore.profi-marketing-llc.workers.dev/api/auth/start";

async function handleSubmit(e) {
  e.preventDefault();
  const form = e.target;
  const data = {
    first_name: form.first_name.value.trim(),
    last_name: form.last_name.value.trim(),
    email: form.email.value.trim(),
    company_name: form.company_name?.value.trim() || "",
    is_business: form.is_business.checked,
  };

  try {
    const res = await fetch(API_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data),
    });
    const result = await res.json();
    if (result.ok) {
      alert("✅ Magic-Link wurde gesendet! Bitte prüfe dein E-Mail-Postfach.");
      form.reset();
    } else {
      alert("❌ Fehler: " + (result.message || result.error));
    }
  } catch (err) {
    alert("⚠️ Netzwerkfehler: " + err.message);
  }
}
---

<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SmartPages Login</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <style>
      :root {
        --navy: #1E2A45;
        --yellow: #F5B400;
        --orange: #E47E00;
        --purple: #4B3CFB;
        --purple-light: #6E5FFB;
        --teal: #4EC5C1;
        --teal-dark: #2CA0C4;
        --shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
      }

      body {
        margin: 0;
        font-family: 'Inter', sans-serif;
        background: #ffffff;
        color: #222;
      }

      header {
        background: var(--navy);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 2rem;
        padding: 1.5rem;
        text-align: center;
      }

      header img {
        width: 120px;
        height: 120px;
      }

      .header-text h1 {
        font-size: 2rem;
        margin: 0;
      }

      .header-text p {
        margin: 0;
        font-size: 1rem;
        opacity: 0.9;
      }

      .hero {
        display: grid;
        grid-template-columns: 1fr 1fr;
        max-width: 1200px;
        margin: 4rem auto;
        gap: 2rem;
        align-items: start;
        padding: 0 2rem;
      }

      .welcome {
        background: #fff;
        box-shadow: var(--shadow);
        padding: 2rem;
        border-radius: 1rem;
      }

      .welcome h2 {
        color: var(--yellow);
        margin: 0;
        font-size: 2rem;
      }

      .welcome h3 {
        margin: 0.3rem 0 1.2rem;
        color: var(--navy);
      }

      form {
        background: #fff;
        box-shadow: var(--shadow);
        padding: 2rem;
        border-radius: 1rem;
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      label {
        font-weight: 500;
      }

      input[type="text"],
      input[type="email"] {
        padding: 0.8rem;
        border: 1px solid #ccc;
        border-radius: 0.5rem;
        font-size: 1rem;
      }

      .checkbox {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      button {
        background: linear-gradient(135deg, var(--yellow), var(--orange));
        color: white;
        font-weight: bold;
        padding: 0.9rem;
        border: none;
        border-radius: 0.6rem;
        cursor: pointer;
        font-size: 1rem;
        transition: transform 0.2s, box-shadow 0.2s;
      }

      button:hover {
        transform: scale(1.02);
        box-shadow: var(--shadow);
      }

      .products {
        max-width: 1200px;
        margin: 4rem auto;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
        padding: 0 2rem;
      }

      .card {
        border-radius: 1rem;
        color: white;
        padding: 2rem;
        box-shadow: var(--shadow);
        transition: all 0.3s ease;
      }

      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.25);
      }

      .smartprofile {
        background: linear-gradient(135deg, var(--purple), var(--purple-light));
      }

      .smartpage {
        background: linear-gradient(135deg, var(--yellow), var(--orange));
      }

      .smartdomain {
        background: linear-gradient(135deg, var(--teal), var(--teal-dark));
      }

      footer {
        text-align: center;
        padding: 2rem;
        background: #f5f5f5;
        font-size: 0.9rem;
        color: #555;
      }

      @media (max-width: 900px) {
        .hero {
          grid-template-columns: 1fr;
        }
        header {
          flex-direction: column;
        }
      }
    </style>
  </head>

  <body>
    <header>
      <img src="/SmartPages_icon_transparent.png" alt="SmartPages Logo" />
      <div class="header-text">
        <h1>SmartPages</h1>
        <p>Wir bringen dich in 10 Minuten online – ohne Technik Wissen</p>
      </div>
    </header>

    <section class="hero">
      <div class="welcome">
        <h2>Herzlich Willkommen</h2>
        <h3>bei SmartPages</h3>
        <p>
          Mit SmartPages startest du in nur wenigen Minuten dein eigenes digitales Zuhause.
          Wir senden dir deinen persönlichen <b>Magic-Link</b>, mit dem du direkt in dein Dashboard gelangst – 
          ohne Passwort oder komplizierte Registrierung.
        </p>
        <p>
          Gib einfach deine Basisdaten ein, damit dein Account korrekt zugeordnet werden kann.
          Du entscheidest, ob du SmartPages privat oder geschäftlich nutzt – der Zugang ist in beiden Fällen kostenlos in der Testphase.
        </p>
      </div>

      <form onsubmit="handleSubmit(event)">
        <label>Vorname *</label>
        <input type="text" name="first_name" required />

        <label>Nachname</label>
        <input type="text" name="last_name" />

        <label>E-Mail *</label>
        <input type="email" name="email" required />

        <div class="checkbox">
          <input type="checkbox" id="is_business" name="is_business" onchange="toggleCompany()" />
          <label for="is_business">Das ist ein Firmenkonto (Business)</label>
        </div>

        <div id="company_field" style="display:none;">
          <label>Firmenname</label>
          <input type="text" name="company_name" />
        </div>

        <button type="submit">Magic-Link senden</button>
      </form>
    </section>

    <section class="products">
      <div class="card smartprofile">
        <h3>SmartProfile</h3>
        <p>Erstelle in Minuten deine zentrale Profilseite mit Branding, Links & Kontakt – ideal für Creator, Influencer und Solopreneure.</p>
      </div>

      <div class="card smartpage">
        <h3>SmartPage</h3>
        <p>Deine persönliche Subdomain mit bis zu 5 frei gestaltbaren Unterseiten. Präsentiere Produkte, Dienstleistungen oder Projekte – individuell & professionell.</p>
      </div>

      <div class="card smartdomain">
        <h3>SmartDomain</h3>
        <p>Gestalte deine eigene Homepage mit deinem Namen und entwickle sie ganz individuell mit unseren Bausteinen.</p>
      </div>
    </section>

    <footer>
      © 2025 SmartPages · Profi Marketing LLC · DSGVO-konform in Europa gehostet
    </footer>

    <script>
      function toggleCompany() {
        const cb = document.getElementById("is_business");
        const field = document.getElementById("company_field");
        field.style.display = cb.checked ? "block" : "none";
      }
    </script>
  </body>
</html>
